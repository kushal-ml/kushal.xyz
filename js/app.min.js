var imagePath = "/images";
var cardPositions = {
  768: {
    profile: {
      zIndex: 11, 
      top: '5%',   // Scattered more to the top-left
      left: '10%',
    },
    "face-capture": {
      zIndex: 7,
      top: '40%',  // Placed more centrally
      left: '20%',
    },
    location: {
      zIndex: 2,
      top: '70%',  // Lower left
      left: '5%',
    },
    "known-associates": {
      zIndex: 8,
      top: '10%',  // Upper right
      left: '60%',
    },
    missions: {
      zIndex: 6,
      top: '25%',
      left: '40%',
    },
    training: {
      zIndex: 9,
      top: '65%',
      left: '50%',
    },
    languages: {
      zIndex: 3,
      top: '80%',
      left: '70%',
    },
    skillset: {
      zIndex: 10,
      top: '50%',
      left: '10%',
    },
    
  },
  980: {
    profile: {
      zIndex: 11,
      top: '5%',
      left: '10%',
    },
    "face-capture": {
      zIndex: 6,
      top: '20%',
      left: '30%',
    },
    location: {
      zIndex: 2,
      top: '55%',
      left: '10%',
    },
    "known-associates": {
      zIndex: 7,
      top: '15%',
      left: '50%',
    },
    missions: {
      zIndex: 5,
      top: '10%',
      left: '70%',
    },
    training: {
      zIndex: 9,
      top: '50%',
      left: '60%',
    },
    languages: {
      zIndex: 10,
      top: '70%',
      left: '80%',
    },
    skillset: {
      zIndex: 8,
      top: '35%',
      left: '80%',
    },
    
  },
  1200: {
    profile: {
      zIndex: 11,
      top: '5%',
      left: '15%',
    },
    "face-capture": {
      zIndex: 6,
      top: '10%',
      left: '40%',
    },
    location: {
      zIndex: 2,
      top: '40%',
      left: '10%',
    },
    "known-associates": {
      zIndex: 7,
      top: '15%',
      left: '70%',
    },
    missions: {
      zIndex: 4,
      top: '10%',
      left: '80%',
    },
    training: {
      zIndex: 5,
      top: '40%',
      left: '60%',
    },
    languages: {
      zIndex: 9,
      top: '60%',
      left: '80%',
    },
    skillset: {
      zIndex: 10,
      top: '30%',
      left: '80%',
    },
   
  },
  1600: {
    profile: {
      zIndex: 11,
      top: '5%',
      left: '10%',
    },
    "face-capture": {
      zIndex: 4,
      top: '10%',
      left: '30%',
    },
    location: {
      zIndex: 2,
      top: '45%',
      left: '5%',
    },
    "known-associates": {
      zIndex: 7,
      top: '10%',
      left: '80%',
    },
    missions: {
      zIndex: 8,
      top: '5%',
      left: '50%',
    },
    training: {
      zIndex: 6,
      top: '50%',
      left: '50%',
    },
    languages: {
      zIndex: 10,
      top: '60%',
      left: '70%',
    },
    skillset: {
      zIndex: 9,
      top: '30%',
      left: '60%',
    },
   
  },
};

var cards = [
  {
    title: "Profile",
    width: 280,
    html: `<div class="profile-image"><img src="${imagePath}/selfie.jpg" alt="Kushal"></div>
		<div class="profile-info">
			<table>
				<tbody>
					<tr><td>Name</td><td>Kushal</td></tr>
					<tr><td>Profession</td><td>Software Engineer, Research Scholar</td></tr>
					<tr><td>Sex</td><td>Male</td></tr>
					<tr><td>Resume</td><td><a href="images/RESUME2024.pdf" download>Download Resume</a></td></tr>
					<tr>
            <td>Contact</td>
            <td>
              <a href="mailto:honeymaheykushal99@gmail.com"><i class="fas fa-envelope"></i></a>
              <a href="https://www.linkedin.com/in/kushal-ml/"><i class="fab fa-linkedin-in"></i></a>
              <a href="https://twitter.com/Kushal_mahey"><i class="fab fa-twitter"></i></a>
              <a href="https://github.com/kushal-ml" target="_blank"><i class="fab fa-github"></i></a>
            </td>
          </tr>
				</tbody>
			</table>
		</div>`,
  },
  {
    title: "Face Capture",
    width: 500,
    html: `<div class="face-capture-image">
			<img src="${imagePath}/face-capture.jpg" alt="Kushal Facial Recognition">
			<div class="face-capture-square"></div>
		</div>
		<div class="profile-info">
			<table>
				<tbody>
					<tr><td>Certification</td><td>Huawei HCIA-AI Certified</td></tr>
					<tr><td>Research Topic</td><td>QA ML Models</td></tr>
				</tbody>
			</table>
		</div>`,
  },
  {
    title: "Location",
    width: 200,
    html: `
			<div class="finland-map-wrap">
				<img class="finland-map" src="${imagePath}/canada.svg" alt="Finland Map">
				    <svg class="canada-map" viewBox="500 500 200 200"> 
				        <path id="ontario" d="M150,150 L250,150 L250,250 L150,250 Z" fill="lightblue"/>
				    </svg>
				<div class="beacon-wrap">
					<div class="beacon-center"></div>
					<div class="beacon"></div>
				</div>
			</div>
		`,
  },
  {
    title: "Projects",
    width: 240,
    html: `
		<div class="profile-info">
			<table>
				<tbody>
					<tr><td>Robustness (Virtual Doctor)</td></tr>
     					<tr><td>Voice-Controlled Email</td></tr>
	  <tr><td>Helmet-Detection-on-Two-wheelers-and-Penalty-Generation-using-Artificial-Intelligence</td></tr>
   <tr><td>Quiz App for Android</td></tr>
   <tr><td>Stock Price Prediction Using AI and Machine Learning</td></tr>
   <tr><td>Dual Chatbot Interface</td></tr>
   <tr><td>Pedestrain Movement Prediction</td></tr>
				</tbody>
			</table>
		</div>`,
  },
  {
    title: "Missions",
    width: 560,
    html: `
			<table>
				<tbody>
					<tr><td>HOBBIES</td><td>Cooking</td><td>Travelling</td><td>Gaming</a></td></tr>
				</tbody>
			</table>
		`,
  },
  {
    title: "Academic Details",
    width: 480,
    html: `<table>
			<tbody>
				<tr>
          <td>Lakehead University</td>
          <td>2023-2025</td>
          <td>Master’s of Science (M.S.) Computer Science</td>
        </tr>
	<tr>
          <td>IKGPTU, INDIA</td>
          <td>2018-2022</td>
          <td>Bachelor of Technology (B.Tech.) Computer Science & Engineering</td>
        </tr>
			</tbody>
		</table>`,
  },
  {
    title: "Programming Languages",
    width: 250,
    html: `<table>
			<tbody>
				<tr><td width="50%">HTML</td><td>C</td></tr>
				<tr><td width="50%">CSS</td><td>C++</td></tr>
        <tr><td>JavaScript</td><td>Python</td></tr>
				<tr><td>jQuery</td><td>SQL</td></tr>
    <tr><td>React</td><td>Node.js</td></tr>
			</tbody>
		</table>`,
  },
  {
    title: "Skillset",
    width: 250,
    html: `<table>
			<tbody>
        <tr><td>Web Development</td></tr>
	<tr><td>Agile Methodologies</td></tr>
	<tr><td>Restful API</td></tr>
 <tr><td>Debugging</td></tr>
 <tr><td>Containerization</td></tr>
 <tr><td>Web Services</td></tr>
 <tr><td>System Scalability</td></tr>
 <tr><td>Performance Optimization</td></tr>
 <tr><td>Microservice Design</td></tr>
 <tr><td>Machine Learning</td></tr>
	<tr><td>Data Science</td></tr>
 <tr><td>Natural Language Processing</td></tr> 
 <tr><td>RDBMS</td></tr>
 <tr><td>Artificial Intelligence</td></tr>
        <tr><td>Computer Vision</td></tr>
        <tr><td>Cloud Computing</td></tr>
        <tr><td>Prompt Engineering</td></tr>
        <tr><td>Data Structures & Algorithms</td></tr>
        <tr><td>API Creation / Integration</td></tr>
        <tr><td>Project Management</td></tr>
        <tr><td>Graphic Design</td></tr>
        <tr><td>DevOps - Git / GitHub</td></tr>
        <tr><td>Teamwork</td></tr>
        <tr><td>Communication</td></tr>
	<tr><td>Problem-Solving</td></tr>
        <tr><td>Code Quality</td></tr>
			</tbody>
		</table>`,
  },
  
];

var highZ = cards.length + 1;
var cardsContainer = document.querySelector(".cards-container");
var cardsContainerWidth = cardsContainer.offsetWidth;

cards.forEach(function (card, i) {
  var zIndex = i === 0 ? cards.length + 1 : cards.length - i;
  var cardClass = card.title.toLowerCase().replace(/ /g, "-");
  var cardStyles = `width: ${card.width}px;`;

  cardsContainer.innerHTML += `
		<div class="card ${cardClass}" style="${cardStyles}" tabindex="0" data-card="${cardClass}">
			<div class="card-header">
				<div class="card-title">
					<h2>${card.title}</h2>
				</div>
				<div class="card-actions">
					<a href="#" class="move-card" tabindex="-1"><i class="fa fa-arrows-alt"></i></a>
				</div>
			</div>
			<div class="card-body">
				${card.html}
			</div>
		</div>
	`;
});

// drag stuff
var dragEl = null;
var startX = 0;
var startY = 0;
var differenceX = 0;
var differenceY = 0;
var cardEls = document.querySelectorAll(".cards-container .card");

cardEls.forEach(function (card) {
  card.onfocus = function () {
    card.style.zIndex = highZ + 1;
    highZ++;
  };
});

function getTouchEvent(e) {
  var touch = e;

  if (
    e.type == "touchstart" ||
    e.type == "touchmove" ||
    e.type == "touchend" ||
    e.type == "touchcancel"
  ) {
    var evt = typeof e.originalEvent === "undefined" ? e : e.originalEvent;
    touch = evt.touches[0] || evt.changedTouches[0];
  }

  return touch;
}

function touchstart(e) {
  var touchEvt = getTouchEvent(e);
  dragEl = null;

  if (!e.target.closest(".send-message") && !e.target.closest(".terminal")) {
    if (e.target.closest(".card")) {
      e.target.closest(".card").style.zIndex = highZ + 1;
      highZ++;
    }

    if (e.target.closest(".card-header") || e.target.closest(".modal-header")) {
      dragEl = e.target.closest(".card")
        ? e.target.closest(".card")
        : e.target.closest(".modal");
      startX = touchEvt.clientX;
      startY = touchEvt.clientY;
      differenceX = startX - dragEl.offsetLeft;
      differenceY = startY - dragEl.offsetTop;
    }
  }
}

function touchmove(e) {
  if (dragEl) {
    var touchEvt = getTouchEvent(e);
    e.preventDefault();
    dragEl.style.left = touchEvt.clientX - differenceX + "px";
    dragEl.style.top = touchEvt.clientY - differenceY + "px";
  }
}

function touchend(e) {
  if (dragEl) {
    dragEl = null;
  }
}

document.onmousedown = touchstart;
document.ontouchstart = touchstart;
document.onmousemove = touchmove;
document.ontouchmove = touchmove;
document.onmouseup = touchend;
document.ontouchend = touchend;

// audio feed
var AudioFeed = function (options) {
  if (!options.container) {
    return;
  }
  var audioFeed = options.container;
  var audioFeedHeight = audioFeed.clientHeight;
  var barColor = options.barColor || "#fff";
  audioFeed.style.width = "100%";
  audioFeed.style.backgroundColor = options.bgColor || "#000";
  audioFeed.style.display = "table";

  var barWidth = Math.floor(audioFeed.clientWidth / 100);

  for (var i = 0; i < 100; i++) {
    audioFeed.innerHTML +=
      '<div class="audio-bar-wrap" style="width: ' +
      barWidth +
      'px; display: table-cell; vertical-align: bottom;"><div class="audio-bar" style="background: ' +
      barColor +
      '; margin: 0 1px; transition: .6s;"></div></div>';
  }

  setInterval(function () {
    var bars = document.querySelectorAll(".audio-bar");

    bars.forEach(function (bar) {
      var barHeight = Math.floor(Math.random() * audioFeedHeight);
      bar.style.height = barHeight + "px";
    });
  }, 100);
};

new AudioFeed({
  container: document.querySelector(".audio-feed-container"),
  barColor: "#67B6B9",
});

// server log
var serverLogContainer = document.querySelector(".server-log-container");
var serverLog = document.querySelector(".server-log .card-body");
var commands = [];

for (var i = 0; i < 20; i++) {
  var ip =
    Math.floor(Math.random() * 255) +
    "." +
    Math.floor(Math.random() * 255) +
    "." +
    Math.floor(Math.random() * 255) +
    "." +
    Math.floor(Math.random() * 255);
  commands.push({ text: "Decrypting " + ip + "...", typing: true });
}

new Terminal({
  container: serverLogContainer,
  typingSpeed: 50,
  loop: true,
  commands: commands,
  lineBegin: function () {
    serverLog.scrollTop = serverLog.scrollHeight;
  },
  pause: 250,
});

var terminalWrap = document.querySelector(".terminal");
var terminalContainer = document.querySelector(".terminal .card-body");

// terminal
if (window.location.pathname === "/") {
  new Terminal({
    container: document.querySelector(".terminal .card-body"),
    typingSpeed: 75,
    commands: [
      {
        text: 'load profile -Name "Kushal" ',
        typing: true,
      },
      {
        text: "loading...",
        typing: false,
      },
    ],
    done: function () {
      setTimeout(function () {
        terminalWrap.style.display = "none";
        cardsContainer.style.visibility = "visible";

        setTimeout(function () {
          cardsContainer.classList.add("loaded");
        });
      }, 1000);
    },
  });
} else {
  new Terminal({
    container: document.querySelector(".terminal .card-body"),
    typingSpeed: 75,
    commands: [
      {
        text: "The page you were looking for does not exist",
        typing: true,
      },
      {
        text: "How did you even get here?",
        typing: true,
      },
      {
        text: '<a href="/">Go Home</a>',
        typing: false,
      },
    ],
  });
}

function positionCards() {
  if (cardsContainer.offsetWidth > 480) {
    var cardsContainerWidth = cardsContainer.offsetWidth;

    cardEls.forEach(function (card) {
      var cardObj = cardPositions[cardsContainerWidth][card.dataset.card];
      card.style.top = cardObj.top + "px";
      card.style.left = cardObj.left + "px";
      card.style.zIndex = cardObj.zIndex;
    });
  }
}

var resizeTimeout;

if (window.location.pathname === "/") {
  window.onresize = function () {
    clearTimeout(resizeTimeout);

    resizeTimeout = setTimeout(function () {
      positionCards();
    }, 500);
  };

  positionCards();
}

var missions = {
  "Working from home": `
		<h3>Role</h3>
		<p>Senior Full Stack Engineer / Tech Lead</p>

		<h3>Directives</h3>
		<p>▪ Created a server-side application using Node.js and Express to support real-time communication between client and server.</p>
    <p>▪ Optimized websites for maximum speed and scalability, while also ensuring compatibility with various browsers and devices.</p>
    <p>▪ Debugged and fixed application issues in a timely manner.</p>
    <p>▪ Developed features and optimized existing code to improve application scalability.</p>
    <p>▪ Developed a RESTful API to allow for interoperability between different systems.</p>
    <p>▪ Utilized a variety of programming languages, including Objective-C, Java, and Swift, to build mobile applications.</p>
    <p>▪ Developed end-to-end mobile applications, including back-end connectivity to web services and databases.</p>
    <p>▪ Provided technical support to customers regarding software issues.</p>
    <p>▪ Collaborated with other developers and designers to ensure the successful development of web applications.</p>
	`,
  Oivan: `
		<h3>Role</h3>
		<p>Full Stack Developer</p>

		<h3>Directives</h3>
		<p>▪ Building unprecedented UI/UX for end users using React.js</p>
    <p>▪ Real time Chat using Socket.io and put human like AI</p>
    <p>▪ Developed and implemented front-end architecture to support user interface concepts with 100% accuracy</p>
    <p>▪ Developed a backend solution to increase system efficiency by 20%, resulting in faster completion of projects.</p>
    <p>▪ Maintained and monitored backend services and databases to ensure optimal performance.</p>
    <p>▪ Developed a RESTful API to allow for interoperability between different systems.</p>
    <p>▪ Utilized AWS technologies to create a highly available and cost effective backend environment.</p>
    <p>▪ Developed a mobile application for iOS and Android platforms that increased user engagement by 20%</p>
    <p>▪ Implemented modern software development practices to optimize code performance and improve user experience</p>
    <p>▪ Utilized RESTful APIs to integrate mobile applications with backend services</p>
	`,
  "Arter Oy": `
		<h3>Role</h3>
		<p>Full Stack Developer</p>

		<h3>Directives</h3>
    <p>▪ Implemented a user-friendly front-end design with HTML5, CSS3, and jQuery to ensure an excellent user experience.</p>
    <p>▪ Used modern development tools such as Git and GitHub to collaborate on code and create version control.</p>
    <p>▪ Optimized webpages for performance, scalability, and security using technologies such as AJAX and RESTful APIs.</p>
    <p>▪ Developed a full stack application using Node.js, Express, Angular, React, Vue, MySQL and MongoDB to enable users to interact with a dynamic content management system.</p>
    <p>▪ Understanding of service-oriented architecture and micro-services using Docker/containers and relational databases</p>
    <p>▪ Participate in usability testing and user research to collate user feedback at all levels with detailed documentation</p>
    <p>▪ Communicate frontend best practices to the team, enhancing efficiency and performance across the department</p>
	`,
};

// modal
var modalHighZ = 100;
var lastFocusEl;

function moveForward(e) {
  e.target.closest(".modal").style.zIndex = modalHighZ + 1;
  modalHighZ++;
}

function modal(e) {
  e.preventDefault();
  lastFocusEl = e.target;

  var title = e.target.dataset.title;
  var slug = title
    .toLowerCase()
    .replace(/ /g, "-")
    .replace(/\./g, "")
    .replace(/,/g, "");
  var body = missions[title];

  modalHighZ++;

  if (document.querySelector(".modal." + slug)) {
    document.querySelector(".modal." + slug).style.zIndex = modalHighZ + 1;
  } else {
    var m = document.createElement("div");
    var cardsContainerWidth = cardsContainer.offsetWidth;
    var leftPos =
      cardsContainerWidth <= 480
        ? Math.floor(Math.random() * 5) + 5 + "%"
        : Math.floor(Math.random() * 20) + 20 + "%";
    var topPos = Math.floor(Math.random() * 30) + 30 + "%";
    m.classList = "modal " + slug;
    m.style.left = leftPos;
    m.style.top = topPos;
    m.style.zIndex = modalHighZ;
    m.ontouchstart = moveForward;
    m.onmousedown = moveForward;
    m.tabIndex = 0;
    m.innerHTML = `
			<div class="modal-header">
				<div class="modal-title">Mission: ${title}</div>
				<div class="modal-actions"><a title="Close Modal" href="#" onclick="closeModal(event)"><i class="fa fa-times"></i></a></div>
			</div>
			<div class="modal-body">
				<span class="classified">CLASSIFIED</span>
				${body}
			</div>
		`;
    document.body.appendChild(m);
    setTimeout(function () {
      m.focus();
    });
  }
}

function closeModal(e) {
  e.preventDefault();
  e.target.closest(".modal").remove();
  lastFocusEl.focus();
}
